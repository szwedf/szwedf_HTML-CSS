<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HOTEL AURELIA TOKYO | ラグジュアリーホテル</title>
  <meta name="description" content="東京のラグジュアリーホテル『HOTEL AURELIA TOKYO』。客室・ダイニング・スパ・ウェディングのご案内、特別オファー、アクセス情報をご覧いただけます。" />

  <!-- OGP / JSON-LD（最低限） -->
  <meta property="og:title" content="HOTEL AURELIA TOKYO" />
  <meta property="og:description" content="東京のラグジュアリーホテル。客室・ダイニング・スパ・ウェディングのご案内。" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://images.unsplash.com/photo-1528909514045-2fa4ac7a08ba?q=80&w=1600&auto=format&fit=crop" />
  <script type="application/ld+json">
  {"@context":"https://schema.org","@type":"Hotel","name":"HOTEL AURELIA TOKYO",
   "address":{"@type":"PostalAddress","addressCountry":"JP","addressLocality":"Minato","addressRegion":"Tokyo"},
   "telephone":"+81-3-0000-0000","url":"https://example.com/",
   "amenityFeature":[
     {"@type":"LocationFeatureSpecification","name":"Spa","value":true},
     {"@type":"LocationFeatureSpecification","name":"Fitness Center","value":true},
     {"@type":"LocationFeatureSpecification","name":"Wedding Chapel","value":true}
   ]}
  </script>

  <!-- Fonts / Styles -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600&family=Noto+Serif+JP:wght@500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="hotelstyle.css" />

  <!-- ▼ DatePicker -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ja.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script defer src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ja.js"></script>

</head>
<body>
  <a href="#main" class="skip">本文へスキップ</a>

  <!-- ===== Header ===== -->
  <header>
    <div class="container nav" role="navigation" aria-label="トップナビ">
      <div class="brand"><a href="#">HOTEL AURELIA TOKYO</a></div>
      <nav class="menu" aria-label="メニュー">
        <a href="#rooms">客室・スイート</a>
        <a href="#dining">ダイニング</a>
        <a href="#spa">スパ</a>
        <a href="#wedding">ウェディング</a>
        <a href="#offers">オファー</a>
        <a href="gallery.html">ギャラリー</a>
        <a href="#access">アクセス</a>
      </nav>
      <div class="burger" id="openMenu" aria-label="メニューを開く">☰ メニュー</div>
      <a class="reserve" href="/booking/">ご予約</a>
    </div>
  </header>

  <!-- ===== Hero / Slides ===== -->
  <section class="hero container" aria-label="メインビジュアル">
    <div class="slide show" style="background-image:url('https://images.unsplash.com/photo-1544989164-31dc3c645987?q=80&w=1800&auto=format&fit=crop');"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1519824145371-296894a0daa9?q=80&w=1800&auto=format&fit=crop');"></div>
    <div class="slide" style="background-image:url('https://images.unsplash.com/photo-1566079463188-97d4d6bcdacd?q=80&w=1800&auto=format&fit=crop');"></div>
    <div class="inner">
      <h1>都心の眺望と、静謐なもてなし。</h1>
      <p>麻布十番の高層階から東京を一望。ゆったりとした客室、上質なダイニング、癒やしのスパ体験を。</p>
      <div class="cta">
        <a class="btn gold" href="#booking">空室を検索</a>
        <a class="btn" href="#rooms">客室をみる</a>
        <a class="btn" href="gallery.html">ギャラリー</a>
      </div>
    </div>
  </section>

  <main id="main" class="container" tabindex="-1">

    <section id="booking" class="rooms-section">
  <div class="rooms-layout">
    <aside class="search-panel">
     <form id="searchForm">
  <label for="checkin">チェックイン</label>
  <input id="checkin" name="checkin" class="date-input" type="text" placeholder="YYYY-MM-DD" autocomplete="off">

  <label for="checkout">チェックアウト</label>
  <input id="checkout" name="checkout" class="date-input" type="text" placeholder="YYYY-MM-DD" autocomplete="off">

  <label>ご宿泊人数
    <select name="guests">
      <option value="1">1</option>
      <option value="2" selected>2</option>
      <option value="3">3</option>
      <option value="4">4</option>
    </select>
  </label>

  <label>タイプ
    <select name="type">
      <option value="">指定なし</option>
      <option value="single">シングル</option>
      <option value="double">ダブル</option>
      <option value="twin">ツイン</option>
      <option value="suite">スイート</option>
    </select>
  </label>

  <button class="btn-primary" type="submit">空室を検索</button>
</form>


      <div id="status" style="margin-top:10px;color:var(--muted);font-size:.9rem;"></div>
    </aside>

    <div class="result-wrap">
      <div id="result" class="cards"></div>
    </div>
  </div>
</section>

<!-- 予約モーダル（追加） -->
<dialog id="reserveDialog" style="border:none;border-radius:14px;padding:0;max-width:520px;width:92vw;">
  <form method="dialog" style="padding:16px;border:1px solid var(--line);background:var(--paper);border-radius:14px;">
    <div style="display:flex;justify-content:space-between;gap:12px;align-items:flex-start;">
      <div>
        <div id="dlgTitle" style="font-weight:700;font-size:1.05rem;"></div>
        <div id="dlgSub" style="color:var(--muted);font-size:.9rem;margin-top:4px;"></div>
      </div>
      <button class="btn" value="cancel" aria-label="閉じる">✕</button>
    </div>

    <input type="hidden" id="dlgRoomId">

    <div style="margin-top:12px;display:grid;gap:10px;">
      <label>お名前（必須）
        <input id="dlgName" required placeholder="山田 太郎">
      </label>
      <label>メール（任意）
        <input id="dlgEmail" placeholder="taro@example.com">
      </label>
      <label>備考（任意）
        <input id="dlgNote" placeholder="到着予定時刻など">
      </label>
    </div>

    <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:14px;">
      <button class="btn" value="cancel">キャンセル</button>
      <button id="dlgSubmit" class="btn gold" value="default">この内容で予約確定</button>
    </div>
    <p id="dlgHint" style="color:var(--muted);font-size:.85rem;margin:10px 0 0;"></p>
  </form>
</dialog>


    <!-- ===== Rooms ===== -->
    <section id="rooms" class="section reveal">
      <h2>客室・スイート</h2>
      <p class="lead">広々とした客室と眺望、上質な寝具とアメニティで快適な滞在を。</p>
      <div class="grid" style="margin-top:14px">
        <article class="card">
          <img src="https://images.unsplash.com/photo-1590490360182-c33d57733427?q=80&w=1600&auto=format&fit=crop" alt="デラックスキングの客室" loading="lazy" />
          <div class="body">
            <h3>デラックス キング</h3>
            <p>45㎡、キングベッド、東京ビュー。バス・シャワー別。</p>
            <a class="link" href="room-deluxe.html">詳細を見る →</a>
          </div>
        </article>
        <article class="card">
          <img src="images/room-corner-suite.png" alt="コーナースイートのリビング" loading="lazy" />
          <div class="body">
            <h3>コーナー スイート</h3>
            <p>80㎡、リビング+ベッドルーム、パノラマビュー。</p>
            <a class="link" href="room-corner-suite.html">詳細を見る →</a>
          </div>
        </article>
      </div>
    </section>

    <!-- ===== Dining ===== -->
    <section id="dining" class="section reveal">
      <h2>ダイニング</h2>
      <p class="lead">四季の素材を活かしたコース料理から、アフタヌーンティーまで。</p>
      <div class="grid" style="margin-top:14px">
        <article class="card">
          <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?q=80&w=1600&auto=format&fit=crop" alt="メインダイニングの内観" loading="lazy" />
          <div class="body">
            <h3>メインダイニング</h3>
            <p>コンテンポラリー・キュイジーヌ。ソムリエ厳選のワイン。</p>
            <a class="link" href="#">メニューを見る →</a>
          </div>
        </article>
        <article class="card">
          <img src="https://images.unsplash.com/photo-1559339352-11d035aa65de?q=80&w=1600&auto=format&fit=crop" alt="ティーラウンジの様子" loading="lazy" />
          <div class="body">
            <h3>ティーラウンジ</h3>
            <p>東京の眺望とともに、季節のアフタヌーンティーを。</p>
            <a class="link" href="#">予約する →</a>
          </div>
        </article>
      </div>
    </section>

    <!-- ===== Spa ===== -->
    <section id="spa" class="section reveal">
      <h2>スパ＆フィットネス</h2>
      <p class="lead">オリエンタルボタニカルの香りに包まれるトリートメント。25mプールと最新ジム完備。</p>
      <div class="split" style="margin-top:14px">
        <div class="media-frame">
          <img class="img-cover" src="https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?q=80&w=1600&auto=format&fit=crop" alt="スパのトリートメントルーム" loading="lazy" />
        </div>
        <div>
          <h3 style="margin:0 0 6px">トリートメント</h3>
          <p class="lead">90分のシグネチャーコース、ボディ＆フェイシャルをはじめ多彩なメニュー。</p>
          <ul style="margin:0 0 12px 1.2rem"><li>10:00–22:00（最終受付20:30）</li><li>ご宿泊者以外も利用可（要予約）</li></ul>
          <a class="btn gold" href="#">スパを予約</a>
        </div>
      </div>
    </section>

    <!-- ===== Wedding ===== -->
    <section id="wedding" class="section reveal">
      <h2>ウェディング</h2>
      <p class="lead">光あふれるチャペルと、ボールルーム。専任プランナーが一日をサポート。</p>
      <div class="grid" style="margin-top:14px">
        <article class="card">
          <img src="https://images.unsplash.com/photo-1522673607200-164d1b6ce486?q=80&w=1600&auto=format&fit=crop" alt="チャペルのバージンロード" loading="lazy" />
          <div class="body">
            <h3>チャペル</h3>
            <p>自然光が降り注ぐ純白の空間。</p>
            <a class="link" href="#">フェアを見る →</a>
          </div>
        </article>
        <article class="card">
          <img src="https://images.unsplash.com/photo-1511578314322-379afb476865?q=80&w=1600&auto=format&fit=crop" alt="披露宴会場のテーブルコーディネート" loading="lazy" />
          <div class="body">
            <h3>ボールルーム</h3>
            <p>最大200名。クラシカルな装花が映える会場。</p>
            <a class="link" href="#">プランを見る →</a>
          </div>
        </article>
      </div>
    </section>

    <!-- ===== Offers ===== -->
    <section id="offers" class="section reveal">
      <h2>オファー</h2>
      <p class="lead">ご宿泊・ダイニングの特典プランをご用意しました。</p>
      <div class="grid" style="margin-top:14px">
        <article class="card">
          <img src="https://images.unsplash.com/photo-1542314831-068cd1dbfeeb?q=80&w=1600&auto=format&fit=crop" alt="朝食のイメージ" loading="lazy" />
          <div class="body">
            <h3>ベッド＆ブレックファスト</h3>
            <p>ルームサービスの朝食付き。最上階確約のアップグレード特典。</p>
            <a class="link" href="#">今すぐ予約 →</a>
          </div>
        </article>
        <article class="card">
          <img src="https://images.unsplash.com/photo-1483721310020-03333e577078?q=80&w=1600&auto=format&fit=crop" alt="スパの施術イメージ" loading="lazy" />
          <div class="body">
            <h3>スパ＆ステイ</h3>
            <p>シグネチャー・トリートメント90分+レイトチェックアウト。</p>
            <a class="link" href="#">詳細 →</a>
          </div>
        </article>
        <article class="card">
          <img src="https://images.unsplash.com/photo-1506377247377-2a5b3b417ebb?q=80&w=1600&auto=format&fit=crop" alt="アニバーサリーケーキ" loading="lazy" />
          <div class="body">
            <h3>アニバーサリー</h3>
            <p>シャンパーニュ＆ケーキで記念日を彩るステイ。</p>
            <a class="link" href="#">詳細 →</a>
          </div>
        </article>
      </div>
    </section>

    <!-- ===== Access ===== -->
    <section id="access" class="section reveal">
      <h2>アクセス</h2>
      <p class="lead">東京メトロ南北線麻布十番駅徒歩30秒 都内最高級住宅地で優雅なひとときをお過ごしください。</p>
      <div class="split" style="margin-top:14px">
        <div class="media-frame">
          <img class="img-cover" src="https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?q=80&w=1600&auto=format&fit=crop" alt="六本木の夜景" loading="lazy">
        </div>
        <div>
          <h3 style="margin:0 0 6px">所在地</h3>
          <p>〒106-0032 東京都港区麻布十番4丁目1-4</p>
          <p><strong>電話：</strong>03-7434-2817 <strong>メール：</strong>info@example.com</p>
          <a class="btn" href="https://maps.google.com" target="_blank" rel="noreferrer">Googleマップで開く</a>
        </div>
      </div>
    </section>

  </main>

  <!-- ===== Footer ===== -->
  <footer>
    <div class="container">© <span id="y"></span> HOTEL AURELIA TOKYO — これは学習用のデモサイトです。</div>
  </footer>

  <!-- Mobile drawer -->
  <div class="overlay" id="overlay" aria-hidden="true">
    <div class="drawer" role="dialog" aria-label="モバイルメニュー">
      <a href="#rooms">客室・スイート</a>
      <a href="#dining">ダイニング</a>
      <a href="#spa">スパ</a>
      <a href="#wedding">ウェディング</a>
      <a href="#offers">オファー</a>
      <a href="#access">アクセス</a>
      <a class="reserve" href="/booking/">ご予約</a>
    </div>
  </div>

 <script>
  // 年号
  document.getElementById('y').textContent = new Date().getFullYear();

  // ヒーロー（クロスフェード）
  const slides=[...document.querySelectorAll('.hero .slide')];
  let idx=0;
  setInterval(()=>{
    slides[idx].classList.remove('show');
    idx=(idx+1)%slides.length;
    slides[idx].classList.add('show');
  }, 6000);

  // Intersection reveal
  const io=new IntersectionObserver(es=>{
    es.forEach(e=>{
      if(e.isIntersecting){
        e.target.classList.add('in');
        io.unobserve(e.target);
      }
    });
  },{threshold:.18});
  document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

  // モバイルメニュー
  const overlay=document.getElementById('overlay');
  document.getElementById('openMenu').addEventListener('click',()=>{
    overlay.classList.add('open');
    overlay.setAttribute('aria-hidden','false');
  });
  overlay.addEventListener('click',e=>{
    if(e.target===overlay){
      overlay.classList.remove('open');
      overlay.setAttribute('aria-hidden','true');
    }
  });

  // スムーズスクロール
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click',e=>{
      const id=a.getAttribute('href').slice(1);
      const el=document.getElementById(id);
      if(el){
        e.preventDefault();
        el.scrollIntoView({behavior:'smooth', block:'start'});
        overlay.classList.remove('open');
      }
    });
  });

  // ===== ここから：DB連携（search_rooms.php / create_reservation.php） =====
  const SEARCH_API  = './api/search_rooms.php';
  const RESERVE_API = './api/create_reservation.php';
  const API = '/hotel-admin/api/availability.php';

  const form = document.getElementById('searchForm');
  const box  = document.getElementById('result');
  const statusEl = document.getElementById('status');

  const dlg = document.getElementById('reserveDialog');
  const dlgTitle = document.getElementById('dlgTitle');
  const dlgSub = document.getElementById('dlgSub');
  const dlgRoomId = document.getElementById('dlgRoomId');
  const dlgName = document.getElementById('dlgName');
  const dlgEmail = document.getElementById('dlgEmail');
  const dlgNote = document.getElementById('dlgNote');
  const dlgHint = document.getElementById('dlgHint');
  const dlgSubmit = document.getElementById('dlgSubmit');

  const yen = (n) => '¥' + Number(n).toLocaleString('ja-JP');

  // flatpickr（idが checkin/checkout であること！）
 document.addEventListener('DOMContentLoaded', () => {
  // 年号
  const y = document.getElementById('y');
  if (y) y.textContent = new Date().getFullYear();

  // ヒーロー（クロスフェード）
  const slides = [...document.querySelectorAll('.hero .slide')];
  if (slides.length >= 2) {
    let idx = 0;
    setInterval(() => {
      slides[idx].classList.remove('show');
      idx = (idx + 1) % slides.length;
      slides[idx].classList.add('show');
    }, 6000);
  }

  // Reveal（JSが使えない環境では強制表示）
  const reveals = document.querySelectorAll('.reveal');
  if (reveals.length) {
    if ('IntersectionObserver' in window) {
      const io = new IntersectionObserver((es) => {
        es.forEach((e) => {
          if (e.isIntersecting) {
            e.target.classList.add('in');
            io.unobserve(e.target);
          }
        });
      }, { threshold: 0.18 });
      reveals.forEach((el) => io.observe(el));
    } else {
      reveals.forEach((el) => el.classList.add('in'));
    }
  }

  // モバイルメニュー（要素がある時だけ）
  const overlay = document.getElementById('overlay');
  const openMenu = document.getElementById('openMenu');
  if (overlay && openMenu) {
    openMenu.addEventListener('click', () => {
      overlay.classList.add('open');
      overlay.setAttribute('aria-hidden', 'false');
    });
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) {
        overlay.classList.remove('open');
        overlay.setAttribute('aria-hidden', 'true');
      }
    });
  }

  // flatpickr（読み込み失敗しても落とさない）
  if (typeof flatpickr === 'function') {
    const today = new Date();
    const tomorrow = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 1);

    let outPicker;
    flatpickr('#checkin', {
      locale: 'ja',
      minDate: today,
      dateFormat: 'Y-m-d',
      disableMobile: true,
      onChange(selectedDates) {
        if (!selectedDates[0] || !outPicker) return;
        const minOut = new Date(selectedDates[0].getTime() + 86400000);
        outPicker.set('minDate', minOut);
        if (!outPicker.input.value) outPicker.open();
      }
    });

    outPicker = flatpickr('#checkout', {
      locale: 'ja',
      minDate: tomorrow,
      dateFormat: 'Y-m-d',
      disableMobile: true
    });
  } else {
    console.warn('flatpickr が読み込めてない');
  }
});
const today = new Date();
const tomorrow = new Date(today.getFullYear(), today.getMonth(), today.getDate() + 1);

let outPicker;

const inPicker = flatpickr('#checkin', {
  locale: 'ja',
  minDate: today,
  dateFormat: 'Y-m-d',
  disableMobile: true,
  onChange(selectedDates) {
    if (!selectedDates[0] || !outPicker) return;
    const minOut = new Date(selectedDates[0].getTime() + 86400000);
    outPicker.set('minDate', minOut);
    // チェックアウト未入力なら開く
    if (!document.querySelector('#checkout').value) outPicker.open();
  }
});

outPicker = flatpickr('#checkout', {
  locale: 'ja',
  minDate: tomorrow,
  dateFormat: 'Y-m-d',
  disableMobile: true
});
form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const fd = new FormData(form);
  const params = new URLSearchParams(fd);

  box.textContent = '検索中…';

  try {
    const res = await fetch(`${API}?${params.toString()}`);
    if (!res.ok) {
      const t = await res.text();
      throw new Error(`HTTP ${res.status}: ${t}`);
    }
    const data = await res.json();

    if (!data.rooms || data.rooms.length === 0) {
      box.textContent = '空室がありません。';
      return;
    }
    box.innerHTML = data.rooms.map(r => `
      <article class="card">
        <img src="${r.image || 'https://images.unsplash.com/photo-1590490360182-c33d57733427?q=80&w=1600&auto=format&fit=crop'}" alt="${r.type || ''}" loading="lazy">
        <div class="body">
          <h3>${r.name || (r.type ? r.type.toUpperCase() : 'ROOM')}</h3>
          <p class="meta">定員 ${r.capacity} ・ ¥${Number(r.price).toLocaleString()} / 泊</p>

          <a class="btn gold"
            href="booking.html?roomId=${encodeURIComponent(r.id)}&checkin=${encodeURIComponent(fd.get('checkin'))}&checkout=${encodeURIComponent(fd.get('checkout'))}&guests=${encodeURIComponent(fd.get('guests'))}">
            この部屋を予約
          </a>
        </div>
      </article>
    `).join('');



  } catch (err) {
    console.error(err);
    box.textContent = '検索に失敗（通信/サーバエラー）';
  }
});

</script>

</body>
</html>
